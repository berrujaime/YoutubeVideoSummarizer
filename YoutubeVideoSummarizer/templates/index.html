{% load static %}
<!DOCTYPE html>
<html lang="es" data-bs-theme="light">
<link rel="shortcut icon" type="image/png" href="{% static 'myfavicon.ico' %}"/>
<style>
    /* Estilo para fijar el footer en la parte inferior */
    body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    main {
        flex: 1;
    }

    footer {
        flex-shrink: 0;
    }

    .centered {
        position: fixed;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .btn-danger {
        background-color: #FF0000 !important;
        border-color: #FF0000 !important;
    }
    /* Define the hover state */
    .btn-danger:hover {
        background-color: #DD0000 !important; /* Darker shade for hover */
        border-color: #DD0000 !important;    /* Darker shade for hover border */
    }

</style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="YouTube Video Summarizer is an online tool that allows you to quickly and easily summarize YouTube videos into text. Get concise or detailed answers in seconds!">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="YouTube Video Summarizer">
    <meta property="og:description" content="YouTube Video Summarizer is an online tool that allows you to quickly and easily summarize YouTube videos into text. Get concise or detailed answers in seconds!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ytsummarizer.es">
    <meta property="og:image" content="https://i.ibb.co/ngJykVk/YOUTUBE-VIDEO-SUMMARIZER.png">
    <meta property="og:image:secure_url" content="https://i.ibb.co/ngJykVk/YOUTUBE-VIDEO-SUMMARIZER.png">
    <meta property="og:image:alt" content="Description image of the website">
    <meta property="og:locale" content="es_ES">
    <title>YouTube Video Summarizer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <main>
        <nav class="navbar navbar-expand-lg bg-body-tertiary z-3">
            <div class="container-fluid">
            <a id="logo" class="navbar-brand" href="/"><span style="color: #FF0000;">YouTube</span> Video Summarizer</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a id="navInicio" class="nav-link active" aria-current="page" href="/">Inicio</a>
                </li>
                <!--li class="nav-item">
                    <a id="navDonar" class="nav-link" href="/donate">Donar</a>
                </li-->
                <li class="nav-item dropdown">
                    <a id="selectorIdioma" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="{% static 'es.svg' %}" alt="ES" width="16" height="16">
                        <strong>ES</strong>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a id="selectorES" class="dropdown-item w-auto" style="cursor: pointer">
                                <span><img src="{% static 'es.svg' %}" alt="ES" width="16" height="16">
                                <strong>ES</strong>
                            </a>
                        </li>
                        <li>
                            <a id="selectorEN" class="dropdown-item" style="cursor: pointer">
                                <span><img src="{% static 'gb.svg' %}" alt="ES" width="16" height="16">
                                <strong>EN</strong>
                            </a>
                        </li>
                        <li>
                            <a id="selectorFR" class="dropdown-item" style="cursor: pointer">
                                <span><img src="{% static 'fr.svg' %}" alt="ES" width="16" height="16">
                                <strong>FR</strong>
                            </a>
                        </li>
                    </ul>
                </li>
                </ul>
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0"></ul>
                <li class="nav-item dropdown" style="display: block">
                    <a class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="modo"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sun-fill" viewBox="0 0 16 16">
                            <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"/>
                            </svg><!--By default-->
                    </a>
                    <ul class="dropdown-menu dropdown-menu-md-end">
                        <li>
                            <a id="selectorModoClaro" class="dropdown-item" style="cursor: pointer"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sun-fill" viewBox="0 0 16 16">
                                <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"/>
                                </svg><strong> Light</strong>
                            </a>
                        </li>
                        <li>
                            <a id="selectorModoOscuro" class="dropdown-item" style="cursor: pointer"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
                                <path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"/>
                                <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"/>
                                </svg><strong> Dark</strong>
                            </a>
                        </li>
                    </ul>
                </li>
                </ul>
            </div>
            </div>
        </nav>
        <div id="containerForm" class="container mt-4 centered">
            <form id="summarizeForm">
                {% csrf_token %}
                <div id="barraBusqueda" class="row">
                    <div id="adaptacionCenteredBorrar" class="mb-4 col-12 d-flex justify-content-center align-items-center text-center">
                        <h1><span style="color: #FF0000;">YouTube</span> Video Summarizer</h1>
                    </div>
                    <div id="adaptacionCentered1" class="col-12 d-flex justify-content-center align-items-center">
                        <div class="col-12 col-md-6 mb-2">
                            <input id="youtubeUrl" name="youtubeUrl" type="text" class="form-control form-control-lg" placeholder="Pega el link de un vídeo de YouTube..." aria-label="Buscar" aria-describedby="basic-addon2">
                        </div>
                    </div>
                    <div id="adaptacionCentered2" class="col-12 d-flex justify-content-center align-items-center">
                        <div class="col-8 col-md-3">
                            <select id="selectorDetalle" class="form-control">
                                <option id="selDetalleTitulo" disabled selected>Selecciona nivel de detalle</option>
                                <option id="selDetalleOpResumida" value="concise">Respuesta resumida</option>
                                <option id="selDetalleOpDetallada" value="extense">Respuesta detallada</option>
                            </select>
                        </div>
                        <div class="col-4 col-md-2 d-flex justify-content-center">
                            <button id="btnResumir" type="submit" class="btn btn-danger">¡Resumir!</button>
                        </div>
                    </div>
                </div>
            </form>
            <div class="mt-3">
                <div class="mt-3">
                    <style>
                        @media (min-width: 576px) {
                            /* Estilos aplicados en pantallas medianas y grandes */
                            .espaciado {
                                margin-right: 30px;
                            }
                        }
                    </style>
                    <div id="miniatura" class="col-md-3 border-0 shadow espaciado" style="margin-bottom: 15px; display: none;">
                        <img src="" class="card-img-top" alt="YouTube Video Miniature" style="max-width: 100%;">
                        <div class="card-body text-center">
                            <h6 id="tituloVideo" class="card-title mb-0"></h6>
                        </div>
                    </div>
                    <div id="summary"></div>
                    <div class="d-flex justify-content-center align-items-center">
                        <div class="text-center border rounded px-2 pt-1 pb-1">
                            <span style="color: #FF0000;">YouTube</span> Video Summarizer is no longer availible due to restrictions implemented by YouTube to obtain the video transcripts. We apologize for the inconvenience.<br>Meanwhile, you can explore the project's <a href="https://github.com/berrujaime/YoutubeVideoSummarizer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"/>
                              </svg> GitHub repository</a> and run it on your machine to continue using it without any restrictions.
                        </div>
                        <div id="loadingGif" class="spinner-grow" role="status" style="display: none; color:#FF0000;">
                            <span class="sr-only"></span>
                        </div>
                    </div>
                </div>
            </div>      
        </div>
        <div class="container mt-4">

        </div>
    </main>
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-4 d-flex align-items-center">
          <a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
            <svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
          </a>
          <span class="text-muted">© 2024 Jaime Berruete Díaz</span>
        </div>
    
        <ul class="nav col-md-4 justify-content-end list-unstyled d-flex me-4 pe-4">
          <li class="ms-3"><a class="text-muted" href="https://www.linkedin.com/in/jaime-berruete-d%C3%ADaz-7b229a195/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-linkedin" viewBox="0 0 16 16">
            <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854zm4.943 12.248V6.169H2.542v7.225zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248S2.4 3.226 2.4 3.934c0 .694.521 1.248 1.327 1.248zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016l.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225z"/>
          </svg></a></li>
          <li class="ms-3"><a class="text-muted" href="https://github.com/berrujaime/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8"/>
          </svg></a></li>
        </ul>
      </footer>
</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
    var idioma = 'es'
    var centrado = true
    
    document.addEventListener('DOMContentLoaded', function () {
        const modoClaro = document.getElementById('selectorModoClaro');
        const modoOscuro = document.getElementById('selectorModoOscuro');
        const modo = document.getElementById('modo');
        const htmlElement = document.querySelector('html');
        
        modoClaro.addEventListener('click', function () {
            activarModoClaro();
        });

        modoOscuro.addEventListener('click', function () {
            activarModoOscuro();
        });

        // Función para activar el modo claro
        function activarModoClaro() {
            htmlElement.setAttribute('data-bs-theme', 'light');
            modo.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"/></svg>'
        }

        // Función para activar el modo oscuro
        function activarModoOscuro() {
            htmlElement.setAttribute('data-bs-theme', 'dark');
            modo.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"/><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"/></svg>'
        }

        const sistemaOperativoTema = window.matchMedia('(prefers-color-scheme: dark)');
    
        // Aplicar el tema según el sistema operativo
        if (sistemaOperativoTema.matches) {
            activarModoOscuro(); // Si el sistema operativo tiene un tema oscuro configurado, activa el modo oscuro
        } else {
            activarModoClaro(); // De lo contrario, activa el modo claro
        }

        // Funciones para cambiar idioma
        const selectorIdioma = document.getElementById('selectorIdioma');
        const selectorES = document.getElementById('selectorES');
        const selectorEN = document.getElementById('selectorEN');
        const selectorFR = document.getElementById('selectorFR');

        // Textos
        const navInicio = document.getElementById('navInicio');
        const navDonar = document.getElementById('navDonar');
        const selDetalleTitulo = document.getElementById('selDetalleTitulo');
        const selDetalleOpResumida = document.getElementById('selDetalleOpResumida');
        const selDetalleOpDetallada = document.getElementById('selDetalleOpDetallada');
        const youtubeUrl = document.getElementById('youtubeUrl');
        const btnResumir = document.getElementById('btnResumir');
        const logo = document.getElementById('logo');

        // Constantes de contenido de selectorIdioma
        const idiomaES = '<img src="https://flagicons.lipis.dev/flags/4x3/es.svg" alt="ES" width="16" height="16"><strong> ES</strong>'
        const idiomaEN = '<img src="https://flagicons.lipis.dev/flags/4x3/gb.svg" alt="EN" width="16" height="16"><strong> EN</strong>'
        const idiomaFR = '<img src="https://flagicons.lipis.dev/flags/4x3/fr.svg" alt="FR" width="16" height="16"><strong> FR</strong>'

        selectorES.addEventListener('click', function () {
            idioma = 'es';
            cambiarIdiomaES();
            history.pushState(null, null, '/es');
        });

        selectorEN.addEventListener('click', function () {
            idioma = 'en';
            cambiarIdiomaEN();
            history.pushState(null, null, '/en');

        });

        selectorFR.addEventListener('click', function () {
            idioma = 'fr';
            cambiarIdiomaFR();
            history.pushState(null, null, '/fr');
        });

        function cambiarIdiomaES(){
            navInicio.textContent = 'Inicio'
            navInicio.setAttribute('href', '/' + idioma)
            navDonar.textContent = 'Donar'
            navDonar.setAttribute('href', '/' + idioma + '/donate')
            logo.setAttribute('href', '/' + idioma)
            selDetalleTitulo.textContent = 'Selecciona nivel de detalle'
            selDetalleOpResumida.textContent = 'Respuesta resumida'
            selDetalleOpDetallada.textContent = 'Respuesta detallada'
            youtubeUrl.placeholder = 'Pega el link de un vídeo de YouTube...'
            btnResumir.textContent = '¡Resumir!'
            selectorIdioma.innerHTML = idiomaES
        }

        function cambiarIdiomaEN(){
            navInicio.textContent = 'Home'
            navInicio.setAttribute('href', '/' + idioma)
            navDonar.textContent = 'Donate'
            navDonar.setAttribute('href', '/' + idioma + '/donate')
            logo.setAttribute('href', '/' + idioma)
            selDetalleTitulo.textContent = 'Select detail level'
            selDetalleOpResumida.textContent = 'Concise answer'
            selDetalleOpDetallada.textContent = 'Extense answer'
            youtubeUrl.placeholder = 'Paste here a YouTube video link...'
            btnResumir.textContent = 'Summarize!'
            selectorIdioma.innerHTML = idiomaEN
        }

        function cambiarIdiomaFR(){
            navInicio.textContent = 'Accueil';
            navInicio.setAttribute('href', '/' + idioma)
            navDonar.textContent = 'Faire un don';
            navDonar.setAttribute('href', '/' + idioma + '/donate')
            logo.setAttribute('href', '/' + idioma)
            selDetalleTitulo.textContent = 'Choisissez le niveau de détail';
            selDetalleOpResumida.textContent = 'Réponse concise';
            selDetalleOpDetallada.textContent = 'Réponse détaillée';
            youtubeUrl.placeholder = 'Collez ici un lien vidéo YouTube...';
            btnResumir.textContent = 'Résumer!';
            selectorIdioma.innerHTML = idiomaFR;
        }

        // Obtener el idioma de la URL
        idioma = window.location.pathname.substr(1); // Eliminar la barra inicial para obtener solo el idioma
        // Verificar el idioma y ejecutar funciones correspondientes
        switch (idioma) {
            case 'es':
                cambiarIdiomaES();
                break;
            case 'en':
                cambiarIdiomaEN()
                break;
            case 'fr':
                cambiarIdiomaFR()
                break;
            default:
                // No hacer nada, ES por defecto
                break;
        }
    });

    function toggleCenter() {
        if(centrado){
            var container = document.getElementById('containerForm');
            container.classList.toggle('centered');
            centrado = false
        }
    }

    function modificarEstructura() {
        // Obtener los elementos que vamos a modificar
        const barraBusqueda = document.getElementById('barraBusqueda');
        const adaptacionCentered1 = document.getElementById('adaptacionCentered1');
        const adaptacionCentered2 = document.getElementById('adaptacionCentered2');
        const input = document.getElementById('youtubeUrl');
        const select = document.getElementById('selectorDetalle');
        const button = document.getElementById('btnResumir');

        // Crear nuevos contenedores
        const newDivInput = document.createElement('div');
        newDivInput.className = 'col-md-6 mb-2';
        const newDivSelect = document.createElement('div');
        newDivSelect.className = 'col-8 col-md-4';
        const newDivButton = document.createElement('div');
        newDivButton.className = 'col-4 col-md-2';
        input.className = 'form-control';

        // Mover los elementos a los nuevos contenedores
        newDivInput.appendChild(input);
        newDivSelect.appendChild(select);
        newDivButton.appendChild(button);

        // Limpiar el contenido original
        barraBusqueda.innerHTML = '';

        // Agregar los nuevos contenedores a barraBusqueda
        barraBusqueda.appendChild(newDivInput);
        barraBusqueda.appendChild(newDivSelect);
        barraBusqueda.appendChild(newDivButton);
    }

    function getVideoIdFromUrl(url) {
        // Método 1: Usando expresiones regulares
        var videoIdRegex = /(?<=v=)[a-zA-Z0-9_-]+(?=&|\?|$)/;
        var match = url.match(videoIdRegex);
        if (match) {
            return match[0];
        }

        // Método 2: Usando URL y querystring
        var parsedUrl = new URL(url);
        if (parsedUrl.hostname == 'youtu.be') {
            return parsedUrl.pathname.substr(1);
        } else if (parsedUrl.hostname == 'www.youtube.com' || parsedUrl.hostname == 'youtube.com') {
            var params = new URLSearchParams(parsedUrl.search);
            if (params.has('v')) {
                return params.get('v');
            } else {
                return parsedUrl.pathname.split('/').pop();
            }
        }

        // Si la URL no coincide con ninguno de los formatos esperados
        return null;
    }


    document.getElementById('summarizeForm').addEventListener('submit', function(event) {
        event.preventDefault();  // Evita que se envíe el formulario de forma predeterminada

        var youtubeUrl = document.getElementById('youtubeUrl').value;
        if (!youtubeUrl) {
            alert('Please enter the URL of a YouTube video');
            return;
        }
        toggleCenter();
        modificarEstructura();

        // Limpiar texto
        //document.getElementById('summary').innerHTML = "";

        // Mostrar miniatura
        youtube_id = getVideoIdFromUrl(youtubeUrl)
        let miniatura = document.getElementById('miniatura');
        miniatura.style.display = 'block';
        miniatura.style.float = '';
        //let loadingGif = document.getElementById('loadingGif');
        //loadingGif.style.display = 'block';

        // Construir la URL de la miniatura del video
        var imagenSrc = 'https://img.youtube.com/vi/' + youtube_id + '/0.jpg';

        // Obtener el elemento img dentro del div 'miniatura' y establecer su src
        var imagen = miniatura.querySelector('img');
        imagen.src = imagenSrc;

        // Poner título
        fetch(`https://noembed.com/embed?dataType=json&url=${youtubeUrl}`)
            .then(res => res.json())
            .then(data => document.getElementById('tituloVideo').textContent = data.title)
        
        /*
        // Obtener el token CSRF
        var csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;

        // Datos del formulario
        var formData = new FormData();
        formData.append('csrfmiddlewaretoken', csrfToken);
        formData.append('youtube_id', youtube_id);
        var detail = document.getElementById('selectorDetalle').value;
        formData.append('detail', detail);
        formData.append('lang', idioma);

        // Enviar la solicitud POST usando Axios
        axios.post('/api/summarize', formData)
            .then(function(response) {
                // Convertir el contenido Markdown a HTML
                var htmlContent = marked.parse(response.data.summary);
                //Cambiar estilos de gif y miniatura
                loadingGif.style.display = 'none';
                miniatura.style.float = 'left';
                // Mostrar el contenido HTML en el elemento 'summary'
                document.getElementById('summary').innerHTML = htmlContent;
            })
            .catch(function(error) {
                loadingGif.style.display = 'none';
                if(idioma == 'en'){
                    //alert("ERROR in your request. Maybe the video don't have any transcription available.");
                    alert("YouTube has blocked API requests to obtain video subtitles from the IP addresses of certain web hosting providers. We are looking for a solution; we apologize for the inconvenience.")
                }
                else if(idioma == 'es'){
                    //alert("ERROR en tu solicitud. Es posible que el video no tenga ninguna transcripción disponible.");
                    alert("YouTube ha bloqueado las peticiones a su api para obtener los subtítulos de los vídeos a las direcciones IPs de ciertos proveedores de alojamiento web. Estamos buscando una solución, disculpe las molestias.")
                }
                else if(idioma == 'fr'){
                    //alert("ERREUR dans votre demande. Peut-être que la vidéo ne possède aucune transcription disponible.");
                    alert("YouTube a bloqué les requêtes à son API pour obtenir les sous-titres des vidéos depuis les adresses IP de certains fournisseurs d'hébergement web. Nous cherchons une solution, veuillez nous excuser pour la gêne occasionnée.")
                }
                else{
                    //alert("ERROR in your request. Maybe the video don't have any transcription available.");
                    alert("YouTube has blocked API requests to obtain video subtitles from the IP addresses of certain web hosting providers. We are looking for a solution; we apologize for the inconvenience.")

                }
            });
        */
    });
</script>
